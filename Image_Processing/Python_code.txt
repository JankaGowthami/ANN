import cv2
import numpy as np
from matplotlib import pyplot as plt

def download_image(url):
    response = requests.get(url)
    if response.status_code == 200:
        image_array = np.asarray(bytearray(response.content), dtype=np.uint8)
        image = cv2.imdecode(image_array, cv2.IMREAD_COLOR)
        return image
    else:
        raise Exception("Failed to download image")

def tickhnovos_filter(image):
    if image is None:
        raise ValueError("Image not loaded properly. Please check the URL.")
    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    blur = cv2.GaussianBlur(gray, (5, 5), 0)
    _, thresh = cv2.threshold(blur, 127, 255, cv2.THRESH_BINARY)
    contours, _ = cv2.findContours(thresh, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
    for contour in contours:
        cv2.drawContours(image, [contour], -1, (0, 255, 0), 2)
    return image

image_url = 'https://th.bing.com/th/id/OIP.oRWDq-aupHGn_qku3auPUAHaEK?w=322&h=181&c=7&r=0&o=5&dpr=1.3&pid=1.7'
image = download_image(image_url)
processed_image = tickhnovos_filter(image)
plt.imshow(cv2.cvtColor(processed_image, cv2.COLOR_BGR2RGB))
plt.title('Processed Image')
plt.axis('off')
plt.show()
